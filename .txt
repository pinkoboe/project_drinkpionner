ğŸ“‹ Drinkpioneer Backend Development Guidelines (Revised)
[Project Context] ìš°ë¦¬ëŠ” **'Drinkpioneer'**ë¼ëŠ” ì£¼ë¥˜ ë²„í‹°ì»¬ í”Œë«í¼ì˜ MVP ë°±ì—”ë“œë¥¼ ê°œë°œ ì¤‘ì…ë‹ˆë‹¤. ì´ ì•±ì€ ìœ„ìŠ¤í‚¤ ë“± ì£¼ë¥˜ ì •ë³´ ì œê³µ, ê°€ê²© ì´ë ¥ ì¶”ì , ê·¸ë¦¬ê³  í–¥í›„ AI ë¸”ë Œë”© ì‹œë®¬ë ˆì´ì…˜ì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤.

[Tech Stack]

Language: Python 3.13

Framework: FastAPI

Database: PostgreSQL (Local host)

Driver: pg8000 (Strictly required for Windows/Unicode compatibility)

ORM: SQLAlchemy (Sync Session ì‚¬ìš©)

Validation: Pydantic v2

Server: Uvicorn

[Current Architecture & Design Pattern] ìš°ë¦¬ëŠ” Layered Architectureë¥¼ ì—„ê²©íˆ ë”°ë¥´ë©°, ê° ê³„ì¸µì˜ ì—­í•  ë¶„ë¦¬ê°€ ëª…í™•í•´ì•¼ í•©ë‹ˆë‹¤.

Model (app/models): SQLAlchemyë¥¼ ì‚¬ìš©í•œ DB í…Œì´ë¸” ì •ì˜ (Base í´ë˜ìŠ¤ ìƒì†). __init__.pyì— ëª¨ë“  ëª¨ë¸ì„ import í•˜ì—¬ create_allì´ë‚˜ Alembicì´ ê°ì§€í•  ìˆ˜ ìˆë„ë¡ í•¨.

Schema (app/schemas): Pydanticì„ ì‚¬ìš©í•œ ë°ì´í„° ê²€ì¦ ë° ì…ì¶œë ¥ ëª¨ë¸ (DTO).

Service (app/services): ì‹¤ì œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§(DB ì €ì¥, íŠ¸ëœì­ì…˜ ê´€ë¦¬, ë³µí•© ë¡œì§) ì²˜ë¦¬.

API (app/api): ë¼ìš°íŒ…, ì˜ì¡´ì„± ì£¼ì…(Dependency Injection), HTTP ìš”ì²­/ì‘ë‹µ ì²˜ë¦¬.

Core (app/core): DB ì—°ê²°(database.py), í™˜ê²½ë³€ìˆ˜ ì„¤ì •(config.py) ë“± ê³µí†µ ì„¤ì •.

[Current Status: Completed Features & Critical Fixes]

Database Connection (Critical):

Windows í™˜ê²½ì˜ CP949 ì¸ì½”ë”© ì¶©ëŒ ë°©ì§€ë¥¼ ìœ„í•´ psycopg2 ëŒ€ì‹  ìˆœìˆ˜ íŒŒì´ì¬ ë“œë¼ì´ë²„ì¸ pg8000ì„ ì±„íƒí–ˆìŠµë‹ˆë‹¤.

.envì˜ DATABASE_URLì€ ë°˜ë“œì‹œ postgresql+pg8000://... í˜•ì‹ì„ ë”°ë¦…ë‹ˆë‹¤.

database.py ì„¤ì • ì™„ë£Œ (expire_on_commit=False ì ìš©).

Admin Product Registration (POST /api/v1/admin/products):

ê´€ë¦¬ìê°€ ìƒí’ˆ ë“±ë¡ ì‹œ Product í…Œì´ë¸”(ê¸°ë³¸ ì •ë³´)ê³¼ PriceHistory í…Œì´ë¸”(ê°€ê²© ì´ë ¥)ì— ë™ì‹œì— ë°ì´í„°ê°€ ì €ì¥ë˜ëŠ” íŠ¸ëœì­ì…˜ ë¡œì§ì´ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

app/models/product.pyì— Product, PriceHistory, Review ëª¨ë¸ ì •ì˜ ë° 1:N ê´€ê³„ ì„¤ì • ì™„ë£Œ.

[Project File Structure]

Plaintext

drinkpioneer_backend/
â”œâ”€â”€ .env                     # DB ì ‘ì† ì •ë³´ (postgresql+pg8000:// í•„ìˆ˜)
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ main.py              # ì•± ì§„ì…ì , ìƒëª…ì£¼ê¸°(DB í…Œì´ë¸” ìë™ ìƒì„±), ë¼ìš°í„° ë“±ë¡
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ config.py        # Pydantic Settings ê´€ë¦¬
â”‚   â”‚   â””â”€â”€ database.py      # DB ì—”ì§„ ë° ì„¸ì…˜ ì„¤ì • (pg8000 ê¸°ë°˜)
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ base.py          # DeclarativeBase
â”‚   â”‚   â”œâ”€â”€ product.py       # Product, PriceHistory, Review ëª¨ë¸
â”‚   â”‚   â””â”€â”€ __init__.py      # ëª¨ë¸ ëª¨ìŒ (Import í•„ìˆ˜)
â”‚   â”œâ”€â”€ schemas/
â”‚   â”‚   â””â”€â”€ product.py       # Pydantic DTO (ProductCreate, ProductResponse)
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â””â”€â”€ product_service.py # ìƒí’ˆ ë“±ë¡ íŠ¸ëœì­ì…˜ ë¡œì§
â”‚   â””â”€â”€ api/
â”‚       â””â”€â”€ v1/admin/product.py # ê´€ë¦¬ììš© ìƒí’ˆ API ë¼ìš°í„°
[Instructions for Next Steps] ìœ„ì˜ êµ¬ì¡°ì™€ ê·œì¹™ì„ ì—„ê²©íˆ ì¤€ìˆ˜í•˜ì—¬ ë‹¤ìŒ ê¸°ëŠ¥ì„ ê°œë°œí•˜ê±°ë‚˜ ë¦¬íŒ©í† ë§í•´ì•¼ í•©ë‹ˆë‹¤.

Driver Compliance: DB ê´€ë ¨ ì‘ì—… ì‹œ ë°˜ë“œì‹œ pg8000 í˜¸í™˜ì„±ì„ ìœ ì§€í•´ì•¼ í•©ë‹ˆë‹¤. psycopg2 ê´€ë ¨ ì˜ì¡´ì„±ì€ ì ˆëŒ€ ì¶”ê°€í•˜ì§€ ë§ˆì„¸ìš”.

Strict Type Hinting: ëª¨ë“  í•¨ìˆ˜(ì¸ì ë° ë°˜í™˜ê°’)ì—ëŠ” Type Hintë¥¼ ëª…ì‹œí•´ì•¼ í•©ë‹ˆë‹¤.

Error Handling: DB ì—°ê²° ì‹¤íŒ¨ë‚˜ ë¡œì§ ì—ëŸ¬ ì‹œ í´ë¼ì´ì–¸íŠ¸ê°€ ì´í•´í•  ìˆ˜ ìˆëŠ” ëª…í™•í•œ HTTPException ë˜ëŠ” ë¡œê·¸ìš© RuntimeErrorë¥¼ ë°œìƒì‹œì¼œì•¼ í•©ë‹ˆë‹¤.

No Circular Imports: ëª¨ë¸(Models), ìŠ¤í‚¤ë§ˆ(Schemas), ì„œë¹„ìŠ¤(Services) ê°„ì˜ ìˆœí™˜ ì°¸ì¡°ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ TYPE_CHECKINGì´ë‚˜ êµ¬ì¡°ì  ë¶„ë¦¬ë¥¼ ê³ ë ¤í•˜ì„¸ìš”.